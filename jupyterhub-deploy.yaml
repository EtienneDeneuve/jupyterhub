  apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    name: jupyterhub
    namespace: jupyterhub
  spec:
    replicas: 1
    template:
      metadata:
        labels:
          app: hub
      spec:
        containers:
        - name: hub
          image: jupyterhub:with_R
          livenessProbe:
            exec:
              command: ["bash", "-c", "bash -c 'timeout -s 9 -k 10s 5s sed -n \"1w /mnt/jupyterhub/podhealth\" <<< \"$(date +%F_%H:%M:%S)\" && echo ok'"]
            initialDelaySeconds: 45
            timeoutSeconds: 2
            periodSeconds: 20
          ports:
          - containerPort: 8081
          - containerPort: 8000
          volumeMounts:
            - mountPath: /home/
              name: pvc-63d99004-1c92-11e7-a4d6-000d3a254011
          resources:
            requests:
              cpu: 100m
      volumes:
        - name: gluster-vc
          glusterfs:
            endpoints: heketi
            path: pvc-63d99004-1c92-11e7-a4d6-000d3a254011
            readOnly: false
